
# Обработчик спектральных данных

Этот Python-скрипт обрабатывает бинарные файлы `.sp` (обычно от флуоресцентных спектрометров PerkinElmer LS55) и преобразует их в читаемые ASCII-текстовые файлы, содержащие метаданные и спектральные данные.


## Обзор

Скрипт разработан для извлечения метаданных (например, тип инструмента, идентификатор образца, длины волн, ширины щелей и т.д.) и спектральных данных (длины волн и интенсивности) из файлов `.sp`, обычно создаваемых флуоресцентными спектрометрами PerkinElmer LS55. Идея проекта возникла из необходимости эффективной обработки таких файлов. Скрипт динамически определяет структуру файлов и сохраняет результаты в двух выходных файлах:
- Файл `_metadata.txt` с обработанными данными в формате BL ASCII.
- Файл `_metadata_details.txt` с подробной информацией о метаданных, включая адреса в памяти.

Скрипт разработан для работы с файлами, где спектральные данные заканчиваются в конце файла.

## Требования
- Python 3.x
- Не требуется дополнительных зависимостей (используются встроенные модули `os`, `struct`, `glob` и `re`)

## Установка
1. Склонируйте репозиторий:
   ```bash
   git clone https://github.com/Salahad-9937/spectrum-converter.git
   cd spectrum-data-processor
   ```
2. Убедитесь, что установлен Python 3:
   ```bash
   python3 --version
   ```

## Использование
1. Поместите ваши файлы `.sp` в ту же директорию, где находится скрипт.
2. Запустите скрипт:
   ```bash
   python3 prepare_data.py
   ```
3. Скрипт обработает все файлы `.sp` в директории и создаст:
   - Файл `filename_metadata.txt` с обработанными данными.
   - Файл `filename_metadata_details.txt` с метаданными и адресами.

### Пример
Для файла `sample.sp` будут созданы выходные файлы:
- `sample_metadata.txt` с содержимым:
  ```
  BL ASCII
  #Hdr
  CreatedBy:
  CreationDate: 15.07.2024 16:21:21
  SampleID: 100510~1
  ...
  #Data
  WL[nm]  _[#]
  320,0   0,2260
  320,5   0,2513
  ...
  ```
- `sample_metadata_details.txt` с содержимым:
  ```
  Metadata Details with Addresses
  Key     Value   Address
  CreatedBy    N/A     N/A
  CreationDate 15.07.2024 16:21:21  104
  SampleID     100510~1  156
  ...
  ```

### Текущие проблемы
Скрипт еще не до конца стабильно работает, и ведутся работы по устранению следующих проблем:
- Возможны ошибки при извлечении некоторых метаданных из-за вариаций в структуре файлов.
- В некоторых случаях спектральные данные могут быть некорректно интерпретированы.
- Необходима дополнительная проверка на различных типах .sp файлов для повышения совместимости.